from gif import create_frame, combine_frames, interp_data
import numpy as np
import imageio


num = 40
dt = 1.82811623
time = np.arange(0, num*dt, dt)

x = np.array([   0.        ,   3.00177723,  13.64516195,  33.20738622,  59.28874176,
   87.81001435, 115.06604101, 140.15187418, 164.84392325, 190.18576302,
  217.62541447, 249.74320247, 291.61002884, 345.90028514, 407.48006754,
  475.46031333, 549.94603608, 630.24166856, 714.96386567, 803.72790832,
  896.37860256, 992.85916111,1093.16015323,1197.26537735,1305.23755452,
 1416.58652046,1530.17134924,1644.87309011,1759.93800035,1875.07812605,
 1990.25116388,2105.43780955,2220.5910357 ,2335.61075306,2450.23264794,
 2563.87668754,2675.71746271,2784.94643742,2891.96163963,2999.99996602])
z = np.array([  0.        ,  0.83125521,  2.81189907,  5.49207574, 10.02937486,
  17.84044697, 28.9488218 , 41.90027168, 55.24425452, 68.5145916 ,
  81.29531796, 92.68382832, 99.69191016, 99.91475667, 99.9151115 ,
  99.91462563, 99.91546428, 99.91702206, 99.92432817, 99.92493632,
  99.92728342, 99.9280034 , 99.94728131, 99.93086118, 99.95549516,
 102.46357433,108.859386  ,118.70931444,130.94721589,144.21075904,
 157.73165576,171.36878406,185.17889345,199.34461428,214.40974234,
 231.28367989,250.54679571,271.93364814,291.60298045,299.99996481])
a = np.array([ 0.12492133, 0.02952486,-0.01895811, 0.06973965, 0.18792869, 0.30309727,
  0.34906585, 0.29414646, 0.28210215, 0.2417602 , 0.18318552, 0.02383716,
 -0.17371992, 0.15069567, 0.15129883, 0.16074984, 0.14558076, 0.11546069,
  0.09604475, 0.08014864, 0.06720266, 0.05440823, 0.04697408, 0.02844422,
  0.04217141, 0.07350207, 0.10041125, 0.1212363 , 0.1294627 , 0.13060295,
  0.13129713, 0.1327248 , 0.1352967 , 0.14183717, 0.15871762, 0.18448351,
  0.21329906, 0.23459098, 0.13656447,-0.03929315])

x_prime, y_prime, a_prime, t_prime = interp_data(x=x, y=z, a=a, t=time, num=300)

for i, t in enumerate(t_prime):
    create_frame(x=x_prime,
                 y=y_prime, 
                 a=1.75*np.rad2deg(a_prime[i]), 
                 i=i,
                 s=10000,
                 figsize=(8,3),
                 xlim=[0,3200],
                 ylim=[-100,400], 
                 xlabel='Horizontal Position (m)', 
                 ylabel='Altitude (m)',
                 title='Minimum energy takeoff with a no-fly zone',
                 fontsize=16,
                 marker_color='black')

frames = combine_frames(t_prime)

imageio.mimsave('nfz.gif', frames, fps = 30)