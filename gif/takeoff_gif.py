from gif import create_frame, combine_frames, interp_data
import numpy as np
import imageio


num = 40
dt = 1.55066567
time = np.arange(0, num*dt, dt)
"""
x = np.array([   0.        ,   3.66229078,  15.26348585,  35.59117768,  64.71724862,
  102.721881  , 148.57460309, 199.50237605, 255.07802251, 315.46941971,
  380.80404883, 450.69976326, 523.96956703, 600.17283526, 679.63031394,
  761.92438582, 846.37285967, 934.28392887,1025.90422347,1120.33896389,
 1216.92004067,1314.87717585,1413.51204869,1512.31631205,1611.27613205,
 1710.46974418,1809.4431618 ,1908.58035824,2007.71149892,2106.80693234,
 2205.84063478,2304.70135445,2402.85242022,2499.28602167,2592.72228691,
 2681.93154139,2766.3759184 ,2846.58389511,2923.4438406 ,2999.99966277])
z = np.array([ 0.00000000e+00,-7.66548428e-02,-9.92798216e-02,-9.91878955e-02,
 -9.90328510e-02,-9.87931521e-02,-9.88289480e-02,-9.82475798e-02,
 -9.87217812e-02,-9.58775277e-02,-9.89696086e-02,-3.90752098e-02,
  1.21829372e+00, 2.29774570e+00, 2.02175097e+00, 4.06624029e+00,
  6.58699991e+00, 3.10010694e+00, 1.76530127e+00, 3.39537960e+00,
  7.33821334e+00, 1.42583235e+01, 2.37692172e+01, 3.52362104e+01,
  4.69608205e+01, 5.87141336e+01, 7.17793673e+01, 8.39282375e+01,
  9.64788127e+01, 1.09177976e+02, 1.22013775e+02, 1.35313982e+02,
  1.50467338e+02, 1.68894072e+02, 1.91215156e+02, 2.16958234e+02,
  2.44042734e+02, 2.69428928e+02, 2.90556149e+02, 2.99999998e+02])
a = np.array([-0.29573282,-0.08152178,-0.09497642,-0.08862308,-0.09352745,-0.07926495,
  0.14126896, 0.14720638, 0.15301506, 0.15331223, 0.12029893, 0.12764657,
  0.11354434, 0.05378197, 0.08151392, 0.128511  ,-0.03615918, 0.01887473,
  0.04543392, 0.05520885, 0.08520177, 0.10676553, 0.12929847, 0.13204522,
  0.11736247, 0.15174479, 0.12521626, 0.13689884, 0.13674035, 0.13878282,
  0.13978194, 0.15810832, 0.19571392, 0.24616613, 0.30115456, 0.34906585,
  0.34906585, 0.34906585, 0.22896209,-0.07539365])
"""

x = np.array([   0.        ,   3.70767653,  14.83330027,  33.2794553 ,  59.1875978 ,
   92.68191434, 133.85317222, 181.81092407, 234.44448435, 291.54936522,
  353.26652022, 419.64052683, 490.05027207, 564.13072919, 641.72263655,
  722.75097714, 807.16743597, 895.01207347, 986.19501421,1080.84589224,
 1178.02017982,1276.11730431,1374.17266037,1471.99967772,1569.71818504,
 1667.40398912,1765.0542393 ,1862.65185452,1960.23370805,2057.8313361 ,
 2155.39869181,2252.91641138,2350.29359053,2447.25551148,2543.40118123,
 2638.02446215,2730.40568283,2820.32521794,2909.30716678,2999.99998981])
z = np.array([ 0.00000000e+00,-3.52956151e-02,-9.89582096e-02,-9.94164010e-02,
 -9.91026036e-02,-9.88757392e-02,-9.89824215e-02,-9.82623903e-02,
 -9.78108977e-02,-9.82806787e-02,-9.83566256e-02,-9.84295807e-02,
 -9.65285942e-02,-8.82874380e-02,-9.72427171e-02,-8.87194718e-02,
 -5.81958166e-02,-9.64727726e-02, 3.57337997e-02,-8.56796680e-02,
  4.72984148e+00, 1.49935227e+01, 2.87643148e+01, 4.37827322e+01,
  5.87980553e+01, 7.36116770e+01, 8.83851344e+01, 1.03187063e+02,
  1.17868115e+02, 1.32437861e+02, 1.47120171e+02, 1.61880406e+02,
  1.76973780e+02, 1.92987470e+02, 2.10418720e+02, 2.30072006e+02,
  2.51964413e+02, 2.74584868e+02, 2.92835938e+02, 3.00000001e+02])
a = np.array([-0.03234891,-0.05948366,-0.03822165,-0.04839695,-0.04849385,-0.05643033,
 -0.0400625 , 0.15947768, 0.14880757, 0.15937989, 0.14860771, 0.11889409,
  0.09716061, 0.08013434, 0.064904  , 0.05651382, 0.0365931 , 0.04448925,
  0.00147602, 0.06123806, 0.1169543 , 0.15289292, 0.16410739, 0.16199618,
  0.15939768, 0.15932349, 0.16077996, 0.15976433, 0.15749437, 0.16001521,
  0.16054217, 0.16236789, 0.17375403, 0.18740993, 0.2164426 , 0.24841505,
  0.27914863, 0.25295825, 0.1230756 ,-0.05211068])

x_prime, y_prime, a_prime, t_prime = interp_data(x=x, y=z, a=a, t=time, num=300)

for i, t in enumerate(t_prime):
    create_frame(x=x_prime,
                 y=y_prime, 
                 a=1.75*np.rad2deg(a_prime[i]), 
                 i=i,
                 s=10000,
                 figsize=(8,3),
                 xlim=[0,3200],
                 ylim=[-100,400], 
                 xlabel='Horizontal Position (m)', 
                 ylabel='Altitude (m)',
                 title='Minimum energy',
                 fontsize=16,
                 marker_color='purple')

frames = combine_frames(t_prime)

imageio.mimsave('takeoff.gif', frames, fps = 30)